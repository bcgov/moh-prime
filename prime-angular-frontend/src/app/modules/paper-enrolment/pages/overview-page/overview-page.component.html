<app-page [busy]="busy">

  <app-page-header>PRIME Profile</app-page-header>

  <app-paper-enrolment-progress-indicator [inProgress]="false"></app-paper-enrolment-progress-indicator>

  <div class="mb-5">
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Enrolment Review</ng-container>
      <ng-container appPageSubheaderSummary>
        Review this information before submitting.
      </ng-container>
    </app-page-subheader>
  </div>

  <app-page-section>
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Enrollee Information</ng-container>

      <button *ngIf="true"
              mat-icon-button
              matTooltip="Edit Preferred Name"
              (click)="onRoute(PaperEnrolmentRoutes.DEMOGRAPHIC)">
        <mat-icon>edit</mat-icon>
      </button>
    </app-page-subheader>

    <app-enrollee-property title="First Name">
      {{ enrollee?.firstName | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Middle Name">
      {{ enrollee?.givenNames | replace: enrollee?.firstName : '' | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Last Name">
      {{ enrollee?.lastName | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Date of Birth">
      {{ enrollee?.dateOfBirth | formatDate }}
    </app-enrollee-property>
  </app-page-section>

  <app-address-view title="Physical Address"
                    [address]="enrollee?.physicalAddress"
                    [showRedirect]="true"
                    [showIfEmpty]="true"
                    (route)="onRoute(PaperEnrolmentRoutes.DEMOGRAPHIC)"></app-address-view>

  <app-page-section>
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Contact Information</ng-container>

      <button *ngIf="true"
              mat-icon-button
              matTooltip="Edit Contact Information"
              (click)="onRoute(PaperEnrolmentRoutes.DEMOGRAPHIC)">
        <mat-icon>edit</mat-icon>
      </button>
    </app-page-subheader>

    <app-enrollee-property title="Phone Number">
      {{ enrollee?.phone | phone | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Optional Extension Number">
      {{ enrollee?.phoneExtension | default }}
    </app-enrollee-property>
  </app-page-section>

  <app-page-section>
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Notification Information</ng-container>

      <button *ngIf="true"
              mat-icon-button
              matTooltip="Edit Notification Information"
              (click)="onRoute(PaperEnrolmentRoutes.DEMOGRAPHIC)">
        <mat-icon>edit</mat-icon>
      </button>
    </app-page-subheader>

    <app-enrollee-property title="Email">
      {{ enrollee?.email | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Optional SMS Phone Number">
      {{ enrollee?.smsPhone | phone | default }}
    </app-enrollee-property>
  </app-page-section>

  <app-page-section>
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Care Setting</ng-container>

      <button *ngIf="true"
              mat-icon-button
              matTooltip="Edit Care Setting"
              (click)="onRoute(PaperEnrolmentRoutes.CARE_SETTING)">
        <mat-icon>edit</mat-icon>
      </button>
    </app-page-subheader>

    <ng-container *ngFor="let careSetting of enrollee?.enrolleeCareSettings">

      <app-enrollee-property title="Care Setting"
                             [makeBold]="true">
        {{ careSetting.careSettingCode | configCode: 'careSettings' }}
      </app-enrollee-property>

    </ng-container>

    <app-enrollee-property *ngIf="!enrollee?.enrolleeCareSettings?.length"
                           title="Care Setting"
                           [makeBold]="true">
      None
    </app-enrollee-property>
  </app-page-section>

  <app-page-section *ngIf="enrollee?.enrolleeHealthAuthorities?.length">
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Health Authority</ng-container>

      <button *ngIf="true"
              mat-icon-button
              matTooltip="Edit Health Authority"
              (click)="onRoute(PaperEnrolmentRoutes.CARE_SETTING)">
        <mat-icon>edit</mat-icon>
      </button>
    </app-page-subheader>

    <ng-container *ngFor="let healthAuthority of enrollee.enrolleeHealthAuthorities">
      <app-enrollee-property title="Health Authority"
                             [makeBold]="true">
        <div class="mb-3">{{ healthAuthority.healthAuthorityCode | configCode: 'healthAuthorities' }}</div>
      </app-enrollee-property>
    </ng-container>
  </app-page-section>

  <app-page-section>
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>College Licence Information</ng-container>

      <button *ngIf="true"
              mat-icon-button
              matTooltip="Edit College Licenses"
              (click)="onRoute(PaperEnrolmentRoutes.REGULATORY)">
        <mat-icon>edit</mat-icon>
      </button>
    </app-page-subheader>

    <ng-container *ngFor="let certification of enrollee?.certifications; let i = index;">

      <app-enrollee-property title="College Licence"
                             [makeBold]="true">
        {{ certification.collegeCode | configCode: 'colleges' | default }}
      </app-enrollee-property>

      <app-enrollee-property title="Licence Class">
        {{ certification.licenseCode | configCode: 'licenses' | default }}
      </app-enrollee-property>

      <app-enrollee-property title="Licence Number">
        {{ certification.licenseNumber | default }}
      </app-enrollee-property>

      <app-enrollee-property title="Prescriber ID">
        {{ certification.practitionerId | default }}
      </app-enrollee-property>

      <app-enrollee-property title="Renewal Date">
        {{ certification.renewalDate | formatDate | default }}
      </app-enrollee-property>

      <app-enrollee-property title="Advanced Practices">
        {{ certification.practiceCode | configCode: 'practices' | default }}
      </app-enrollee-property>

    </ng-container>

    <app-enrollee-property *ngIf="!enrollee?.certifications?.length"
                           title="College Certification"
                           [makeBold]="true">
      None
    </app-enrollee-property>
  </app-page-section>


  <app-page-section *ngIf="enrollee?.oboSites?.length">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Job Site Information</ng-container>

      <button *ngIf="true"
              mat-icon-button
              matTooltip="Edit Job Site Information"
              (click)="onRoute(PaperEnrolmentRoutes.OBO_SITES)">
        <mat-icon>edit</mat-icon>
      </button>
    </app-page-subheader>

    <ng-container *ngFor="let careSetting of enrollee.enrolleeCareSettings">

      <ng-container *ngFor="let oboSite of enrollee.oboSites">
        <ng-container *ngIf="oboSite.careSettingCode === careSetting.careSettingCode">
          <app-enrollee-property title="Care Setting"
                                 [makeBold]="true">
            <div class="mb-3">{{ careSetting.careSettingCode | configCode: 'careSettings' }}
              <span *ngIf="oboSite.careSettingCode === CareSettingEnum.HEALTH_AUTHORITY">
                ({{ oboSite.healthAuthorityCode | configCode: 'healthAuthorities' | capitalize: true }})
              </span>
            </div>

            <app-enrollee-property *ngIf="oboSite.careSettingCode !== CareSettingEnum.HEALTH_AUTHORITY"
                                   title="Site Name"
                                   [makeBold]="true">
              {{ oboSite.siteName | default }}
            </app-enrollee-property>

            <app-enrollee-property *ngIf="oboSite.careSettingCode === CareSettingEnum.HEALTH_AUTHORITY"
                                   title="Facility Name"
                                   [makeBold]="true">
              {{ oboSite.facilityName | default }}
            </app-enrollee-property>

            <app-enrollee-property *ngIf="oboSite.careSettingCode !== CareSettingEnum.HEALTH_AUTHORITY"
                                   title="Site ID"
                                   [makeBold]="true">
              {{ oboSite.pec | default }}
            </app-enrollee-property>

            <app-enrollee-property title="Job Title"
                                   [makeBold]="true">
              {{ oboSite.jobTitle | default }}
            </app-enrollee-property>

            <app-enrollee-property title="Site Address"
                                   [makeBold]="true">
              <app-enrollee-property title="Street">
                {{ oboSite.physicalAddress?.street | default }}
              </app-enrollee-property>

              <app-enrollee-property title="City">
                {{ oboSite.physicalAddress?.city | default }}
              </app-enrollee-property>

              <app-enrollee-property title="Province">
                {{ oboSite.physicalAddress?.provinceCode | configCode: 'provinces' | default }}
              </app-enrollee-property>

              <app-enrollee-property title="Postal Code">
                {{ oboSite.physicalAddress?.postal | postal | default }}
              </app-enrollee-property>

            </app-enrollee-property>
          </app-enrollee-property>
        </ng-container>
      </ng-container>
    </ng-container>

  </app-page-section>

  <app-enrollee-self-declarations *ngIf="enrollee?.selfDeclarations?.length"
                                  [enrolment]="enrollee">
    <button *ngIf="true"
            mat-icon-button
            matTooltip="Edit Self-declaration"
            (click)="onRoute(PaperEnrolmentRoutes.SELF_DECLARATION)">
      <mat-icon>edit</mat-icon>
    </button>
  </app-enrollee-self-declarations>

  <app-page-footer [isInitialEnrolment]="true"
                   (save)="onSubmit()"
                   (back)="onBack()"></app-page-footer>

</app-page>
