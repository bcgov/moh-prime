<app-page-header>Create Banner</app-page-header>

<form (ngSubmit)="onSubmit()"
      [formGroup]="form"
      novalidate>

  <div class="row mb-4">
    <div class="col-sm-12 col-lg-9 col-xl-5 pb-4">

      <mat-form-field class="w-100">
        <input matInput
               placeholder="Title"
               formControlName="title">
        <mat-error>Required</mat-error>
      </mat-form-field>
      <div>
        <mat-form-field class="w-90">
          <mat-label>Location</mat-label>
          <mat-select [formControl]="bannerLocationCode">
            <mat-option [value]="locationCode">
              {{ BannerLocationCode[locationCode] | replace: '_':' ' | capitalize }}
            </mat-option>
          </mat-select>
          <mat-error>Required</mat-error>
        </mat-form-field>

        <app-contextual-help>
          Select which page the banner will be displayed on.
        </app-contextual-help>
      </div>
      <div>
        <mat-form-field class="w-90">
          <mat-label>Type</mat-label>
          <mat-select [formControl]="bannerType">
            <mat-option [value]="BannerType.INFO">
              {{ BannerType[BannerType.INFO] | capitalize }}
            </mat-option>
            <mat-option [value]="BannerType.DANGER">
              {{ BannerType[BannerType.DANGER] | capitalize }}
            </mat-option>
          </mat-select>
          <mat-error>Required</mat-error>
        </mat-form-field>
      </div>

      <div [formGroup]="timeRange">
        <ng-container formGroupName="start">
          <mat-form-field class="mr-2">
            <mat-label>Start Date</mat-label>
            <input matInput
                   [matDatepicker]="startDatePicker"
                   formControlName="date">
            <mat-datepicker-toggle matSuffix
                                   [for]="startDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #startDatePicker></mat-datepicker>
            <mat-error>Required</mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Start Time</mat-label>
            <input matInput
                   mask="AB:CB"
                   [patterns]="hoursTimePattern"
                   formControlName="time"
                   placeholder="00:00"
                   [errorStateMatcher]="hoursErrStateMatcher">
            <mat-error>
              Required
            </mat-error>
          </mat-form-field>
        </ng-container>

        <div formGroupName="end">
          <mat-form-field class="mr-2">
            <mat-label>End Date</mat-label>
            <input matInput
                   [matDatepicker]="endDatePicker"
                   formControlName="date">
            <mat-datepicker-toggle matSuffix
                                   [for]="endDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #endDatePicker></mat-datepicker>
            <mat-error *ngIf="timeRange.hasError('lessthan')">
              Invalid
            </mat-error>
          </mat-form-field>
          <mat-form-field>
            <mat-label>End Time</mat-label>
            <input matInput
                   mask="AB:CB"
                   [patterns]="hoursTimePattern"
                   formControlName="time"
                   placeholder="00:00"
                   [errorStateMatcher]="hoursErrStateMatcher">
            <mat-error>
              Required
            </mat-error>
          </mat-form-field>
          <mat-error *ngIf="timeRange.hasError('lessthan')">
            Invalid
          </mat-error>
        </div>
      </div>

    </div>
    <div class="col-sm-12 col-lg-9 col-xl-7">

      <editor class="mb-4"
              [init]="editorConfig"
              (onKeyUp)="onUpdate($event)"
              (onChange)="onUpdate($event)"
              formControlName="content">
      </editor>

    </div>
  </div>

  <div class="text-right">
    <button mat-flat-button
            [disabled]="!(Role.ADMIN | inRole)"
            color="primary">Publish Banner</button>
  </div>

</form>

<h2 class="mb-2">Preview</h2>

<app-banner [banner]="banner"></app-banner>
