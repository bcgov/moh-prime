<app-page [busy]="busy">
  <ng-container ngProjectAs="top">
    <app-site-collection-notice></app-site-collection-notice>
  </ng-container>

  <app-page-header>PharmaNet Site Registration</app-page-header>
  <app-site-progress-indicator [inProgress]="!site?.completed"
                               [currentRoute]="SiteRoutes.SITE_REVIEW"></app-site-progress-indicator>

  <div class="mb-5">
    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Site Registration Review</ng-container>
      <ng-container appPageSubheaderSummary>
        Review all the information to ensure it is accurate, you will not get approved if any of your information is
        incorrect. If you need to edit your information use the pencil icon to navigate to that section of the
        registration to make changes.
      </ng-container>
    </app-page-subheader>
  </div>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Organization Information</ng-container>
      <mat-icon matTooltip="Edit Organization Information"
                (click)="onRoute(SiteRoutes.ORGANIZATION_INFORMATION)">edit</mat-icon>
    </app-page-subheader>

    <app-enrollee-property title="Organization Number (Legal Entity Operating Site)">
      {{ site.location.organization.name | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Doing Business As">
      {{ site.location.organization.doingBusinessAs | default }}
    </app-enrollee-property>

  </section>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Site Address</ng-container>
      <mat-icon matTooltip="Edit Site Address"
                (click)="onRoute(SiteRoutes.SITE_ADDRESS)">edit</mat-icon>
    </app-page-subheader>

    <app-enrollee-property title="Address">
      {{ site.location?.physicalAddress.street | default }}
    </app-enrollee-property>

    <app-enrollee-property title="City">
      {{ site.location?.physicalAddress.city | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Province">
      {{ site.location?.physicalAddress.provinceCode | configCode: 'provinces' | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Postal Code">
      {{ site.location?.physicalAddress.postal | postal | default }}
    </app-enrollee-property>

    <app-enrollee-property title="Country">
      {{ site.location?.physicalAddress.countryCode | configCode: 'countries' | default }}
    </app-enrollee-property>

  </section>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Vendors</ng-container>
      <mat-icon matTooltip="Edit Vendors"
                (click)="onRoute(SiteRoutes.VENDOR)">edit</mat-icon>
    </app-page-subheader>

    <ng-container *ngFor="let vendor of []">

      <app-enrollee-property>
        {{ site.vendor.name | default }}
      </app-enrollee-property>

    </ng-container>

    <app-enrollee-property *ngIf="!null">
      None
    </app-enrollee-property>

  </section>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Hours of Operation</ng-container>
      <mat-icon matTooltip="Edit Hours of Operation"
                (click)="onRoute(SiteRoutes.HOURS_OPERATION)">edit</mat-icon>
    </app-page-subheader>

    <ng-container *ngFor="let businessDay of site.location.businessHours">
      <app-enrollee-property [title]="businessDay.day | weekday">
        <ng-container *ngIf="businessDay.startTime && businessDay.endTime; else open24Hours">
          {{ businessDay.startTime }}:00 to {{ businessDay.endTime }}:00
        </ng-container>
        <ng-template #open24Hours>
          24 hours
        </ng-template>
      </app-enrollee-property>
    </ng-container>

  </section>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Signing Authority</ng-container>
      <mat-icon matTooltip="Edit Signing Authority"
                (click)="onRoute(SiteRoutes.SIGNING_AUTHORITY)">edit</mat-icon>
    </app-page-subheader>

    <app-registrant-profile-review [party]="site.location.organization.signingAuthority">
    </app-registrant-profile-review>

  </section>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Administrator of PharmaNet Onboarding</ng-container>
      <mat-icon matTooltip="Edit Administrator"
                (click)="onRoute(SiteRoutes.ADMINISTRATOR)">edit</mat-icon>
    </app-page-subheader>

    <app-registrant-profile-review [party]="site.location.administratorPharmaNet">
    </app-registrant-profile-review>

  </section>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Privacy Officer</ng-container>
      <mat-icon matTooltip="Edit Privacy Officer"
                (click)="onRoute(SiteRoutes.PRIVACY_OFFICER)">edit</mat-icon>
    </app-page-subheader>

    <app-registrant-profile-review [party]="site.location.privacyOfficer">
    </app-registrant-profile-review>

  </section>

  <section class="mb-4">

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>Technical Support</ng-container>
      <mat-icon matTooltip="Edit Technical Support Contact"
                (click)="onRoute(SiteRoutes.TECHNICAL_SUPPORT)">edit</mat-icon>
    </app-page-subheader>

    <app-registrant-profile-review [party]="site.location.technicalSupport">
    </app-registrant-profile-review>

  </section>

  <div class="footer mb-4">
    <app-alert *ngIf="!!site.submittedDate"
               type="success"
               icon="check_circle_outline">
      <ng-container #alertTitle
                    class="alert-title">
        Site Registration Submitted
      </ng-container>
      <ng-container #alertContent
                    class="alert-content">
        Your registration has already been submitted. If you have questions please
        contact us at <app-prime-phone></app-prime-phone> or <app-prime-support-email></app-prime-support-email>.
      </ng-container>
    </app-alert>

    <mat-checkbox #accept
                  [checked]="!!site.submittedDate"
                  [disabled]="!!site.submittedDate">
      <div class="pl-3">
        By submitting this form, I hereby certify that all information provided on this form is true and I understand
        that the Ministry of Health and/or Health Insurance BC (HIBC) may verify this information with my regulatory
        body, software vendor, and others as required.
      </div>
    </mat-checkbox>
  </div>

  <div class="row justify-content-end">
    <div class="col text-right">

      <button mat-flat-button
              color="primary"
              [disabled]="!accept.checked || !!site.submittedDate"
              (click)="onSubmit()">Submit Registration</button>

    </div>
  </div>

</app-page>
