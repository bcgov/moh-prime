<app-busy-overlay [busy]="busy">

  <div class="row">
    <div class="col-sm-12 col-md-8 offset-md-1 col-xl-6">

      <app-page-header>PharmaNet Enrolment</app-page-header>

      <div class="mb-5 w-75">
        <app-progress-indicator *ngIf="isInitialEnrolment"
                                [currentRoute]="EnrolmentRoutes.SELF_DECLARATION"></app-progress-indicator>
      </div>

      <form (ngSubmit)="onSubmit()"
            [formGroup]="form"
            novalidate>

        <app-page-subheader>
          <ng-container appPageSubheaderTitle>Self Declaration</ng-container>
          <ng-container appPageSubheaderSummary>
            Self declaration information is collected under the authority of the Information Management Regulation of
            the Pharmaceutical Services Act and confidentiality is protected under the Freedom of Information and
            Protection of Privacy Act. Self declaration information is used to verify the applicant is in good standing
            with their respective College and to determine PharmaNet access eligibility.
          </ng-container>
        </app-page-subheader>

        <ng-container *ngIf="showUnansweredQuestionsError">
          <app-alert type="danger"
                     icon="error_outline">
            <ng-container #alertContent
                          class="alert-content">
              Each self declaration question must be answered before continuing with enrolment!
            </ng-container>
          </app-alert>
        </ng-container>

        <section class="mb-3">

          <p class="question">
            Have you ever been the subject of an order or a conviction for an information contravention?
          </p>

          <mat-radio-group formControlName="hasConviction">
            <mat-radio-button class="mr-4"
                              *ngFor="let decision of decisions"
                              [value]="decision.code">
              {{ decision.name }}
            </mat-radio-button>
          </mat-radio-group>

          <div *ngIf="hasConviction.value"
               class="row">
            <div class="col pt-3">

              <mat-form-field class="w-100">
                <textarea matInput
                          placeholder="Please provide details"
                          rows="5"
                          #hasConvictionInput
                          formControlName="hasConvictionDetails"></textarea>
                <mat-error *ngIf="hasConvictionDetails.hasError('required')">Required</mat-error>
              </mat-form-field>

            </div>
          </div>

        </section>

        <section class="mb-3">

          <p class="question">
            Have you ever had your registration with a governing body of a health profession suspended or cancelled?
          </p>

          <mat-radio-group formControlName="hasRegistrationSuspended">
            <mat-radio-button class="mr-4"
                              *ngFor="let decision of decisions"
                              [value]="decision.code">
              {{ decision.name }}
            </mat-radio-button>
          </mat-radio-group>

          <div *ngIf="hasRegistrationSuspended.value"
               class="row">
            <div class="col pt-3">

              <mat-form-field class="w-100">
                <textarea matInput
                          placeholder="Please provide details"
                          rows="5"
                          #hasRegistrationSuspended
                          formControlName="hasRegistrationSuspendedDetails"></textarea>
                <mat-error *ngIf="hasRegistrationSuspendedDetails.hasError('required')">Required</mat-error>
              </mat-form-field>

            </div>
          </div>

        </section>

        <section class="mb-3">

          <p class="question">
            Have you ever had Terms and Conditions imposed on your license as a result of disciplinary actions taken by
            a governing body?
          </p>

          <mat-radio-group formControlName="hasDisciplinaryAction">
            <mat-radio-button class="mr-4"
                              *ngFor="let decision of decisions"
                              [value]="decision.code">
              {{ decision.name }}
            </mat-radio-button>
          </mat-radio-group>

          <div *ngIf="hasDisciplinaryAction.value"
               class="row">
            <div class="col pt-3">

              <mat-form-field class="w-100">
                <textarea matInput
                          placeholder="Please provide details"
                          rows="5"
                          #hasDisciplinaryAction
                          formControlName="hasDisciplinaryActionDetails"></textarea>
                <mat-error *ngIf="hasDisciplinaryActionDetails.hasError('required')">Required</mat-error>
              </mat-form-field>

            </div>
          </div>

        </section>

        <section class="mb-3">

          <p class="question">
            Have you ever had your access to PharmaNet suspended or revoked?
          </p>

          <mat-radio-group formControlName="hasPharmaNetSuspended">
            <mat-radio-button class="mr-4"
                              *ngFor="let decision of decisions"
                              [value]="decision.code">
              {{ decision.name }}
            </mat-radio-button>
          </mat-radio-group>

          <div *ngIf="hasPharmaNetSuspended.value"
               class="row">
            <div class="col pt-3">

              <mat-form-field class="w-100">
                <textarea matInput
                          placeholder="Please provide details"
                          rows="5"
                          #hasPharmaNetSuspended
                          formControlName="hasPharmaNetSuspendedDetails"></textarea>
                <mat-error *ngIf="hasPharmaNetSuspendedDetails.hasError('required')">Required</mat-error>
              </mat-form-field>

            </div>
          </div>

        </section>

        <app-page-footer [profileCompleted]="isProfileComplete"
                         (save)="onSubmit()"
                         (continue)="onSubmit()"
                         (back)="routeBackTo()"></app-page-footer>

      </form>

    </div>
  </div>

</app-busy-overlay>
