<app-busy-overlay [busy]="busy">

  <form (ngSubmit)="onSubmit()"
        [formGroup]="form"
        novalidate>

    <app-page-header>Application Enrolment</app-page-header>

    <app-page-subheader>
      <ng-container appPageSubheaderTitle>PharmaNet Access</ng-container>
      <ng-container appPageSubheaderSummary>
        Lorem ipsum dolor, sit amet consectetur adipisicing elit.
      </ng-container>
    </app-page-subheader>

    <div class="row mb-3">
      <div class="col-sm-12 col-md-6 col-lg-4">

        <mat-form-field class="w-100">
          <input type="text"
                 placeholder="Organization Type"
                 matInput
                 [formControl]="organizationCtrl"
                 [matAutocomplete]="auto">
          <mat-autocomplete #auto="matAutocomplete"
                            [displayWith]="displayOrganization">
            <mat-option *ngFor="let organizationType of filteredOrganizationTypes"
                        [value]="organizationType"
                        [disabled]="disableOrganization(organizationType.code)">
              {{ organizationType.name }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

      </div>
      <div class="col">

        <button mat-raised-button
                type="button"
                color="primary"
                class="mb-3 mt-1"
                [disabled]="!organizationCtrl.value"
                (click)="addOrganization()">Add Organization</button>

      </div>
    </div>

    <ng-container *ngIf="organizations.length">

      <mat-chip-list class="mat-chip-list-stacked">
        <mat-chip *ngFor="let organization of organizations.controls; let i = index">
          {{ organizationLookup(organization.value.organizationTypeCode) }}
          <mat-icon matChipRemove
                    (click)="removeOrganization(i)">cancel</mat-icon>
        </mat-chip>
      </mat-chip-list>

    </ng-container>

    <div class="row justify-content-between">
      <div class="col pt-4">

        <button mat-stroked-button
                type="button"
                routerLink="../declaration">Back</button>

      </div>
      <div class="col pt-4 text-right">

        <button mat-raised-button
                type="submit"
                color="primary">Save and Continue</button>

      </div>
    </div>

  </form>

</app-busy-overlay>
