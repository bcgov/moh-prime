<app-enrollee-page [busy]="busy">

  <app-page-header>PRIME Enrolment</app-page-header>

  <app-enrolment-progress-indicator *ngIf="isInitialEnrolment"
                                    [inProgress]="isInitialEnrolment"
                                    [currentRoute]="EnrolmentRoutes.CARE_SETTING"></app-enrolment-progress-indicator>

  <form (ngSubmit)="onSubmit()"
        [formGroup]="form"
        novalidate>

    <section class="mb-3">

      <app-page-subheader>
        <ng-container appPageSubheaderTitle>Care Type Setting</ng-container>
        <ng-container appPageSubheaderSummary>
          Identify all of the work settings where you will be accessing PharmaNet. (Note:
          Private Community Health Practice is the only setting currently available in PRIME.)
        </ng-container>
      </app-page-subheader>

      <div class="row">
        <div class="col col-sm-10 py-3"
             formArrayName="careSettings">

          <ng-container *ngFor="let careSetting of careSettings.controls; let i = index;"
                        [formGroupName]="i">

            <app-form-icon-group [show]="careSettings.length > 1"
                                 (event)="removeCareSetting(i)">
              <app-form-icon-group>
                <mat-form-field class="w-100">
                  <mat-label>Care Setting</mat-label>
                  <mat-select formControlName="careSettingCode">
                    <mat-option *ngFor="let careSettingType of filterCareSettingTypes(careSetting)"
                                [value]="careSettingType.code"
                                [disabled]="disableCareSetting(careSettingType.code)">
                      {{ careSettingType.name }}
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="careSetting.get('careSettingCode').hasError('required')">Required
                  </mat-error>
                </mat-form-field>

                <ng-container appContextualContent>
                  Care Setting type is the location where you access PharmaNet to deliver patient care.
                </ng-container>
              </app-form-icon-group>
            </app-form-icon-group>

          </ng-container>

          <button mat-button
                  type="button"
                  color="primary"
                  (click)="addCareSetting()">
            <mat-icon>add</mat-icon>
            Add Additional Care Setting
          </button>

        </div>
      </div>

    </section>

    <section class="mb-3"
             *ngIf="showRemoteAccess()">

      <app-page-subheader>
        <ng-container appPageSubheaderTitle>Remote Access</ng-container>
        <ng-container appPageSubheaderSummary>
          Remote access is use of PharmaNet outside your practice location approved by The Ministry of Health.
          <app-contextual-help class="help">
            “Approved Practice Site” means the physical site at which you provide Direct Patient Care and which
            is approved by the Province for PharmaNet access. For greater certainty, “Approved Practice Site” does
            not include a location from which remote access to PharmaNet takes place.
          </app-contextual-help>
          <br>
          <br>
          For further information, refer to the
          <a target="_blank" rel="noopener noreferrer" href="https://www2.gov.bc.ca/assets/gov/health/practitioner-pro/software-development-guidelines/remote-access-policy-pnet-v10.pdf">
            <u>Policy for Access to PharmaNet Applications via Virtual Private Network (VPN)</u>
          </a> and contact your PharmaNet software vendor for support.
        </ng-container>
      </app-page-subheader>

      <div class="row">
        <mat-checkbox class="ml-3"
                      formControlName="requestingRemoteAccess">Requesting Remote Access</mat-checkbox>
      </div>

    </section>

  </form>

  <app-page-footer [isInitialEnrolment]="isInitialEnrolment"
                   (save)="onSubmit()"
                   (back)="routeBackTo()"></app-page-footer>

</app-enrollee-page>
