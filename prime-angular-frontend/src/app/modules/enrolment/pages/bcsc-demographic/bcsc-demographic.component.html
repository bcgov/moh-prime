<app-enrollee-page [busy]="busy">
  <app-page-header>PRIME Enrolment</app-page-header>
  <app-enrolment-progress-indicator *ngIf="isInitialEnrolment"
                                    [inProgress]="isInitialEnrolment"></app-enrolment-progress-indicator>

  <form (ngSubmit)="onSubmit()"
        [formGroup]="form"
        novalidate>

    <section class="mb-3">
      <app-page-subheader>
        <ng-container appPageSubheaderTitle>Enrollee Information</ng-container>
        <ng-container appPageSubheaderSummary>
          This information comes from your BC Services Card. If you use a different name professionally, please
          select "I have a preferred name."
          <small class="font-italic d-block">
            Entering a preferred name in PRIME won't change your BC Services Card.<br>
            The name you provide must match your College registration information, if applicable.
          </small>
        </ng-container>
      </app-page-subheader>

      <app-bcsc-profile [user]="enrollee"
                        [showAddress]="false"></app-bcsc-profile>

      <app-toggle-content label="I have a preferred name"
                          [checked]="hasPreferredName"
                          (change)="onPreferredNameChange($event)">

        <section>
          <app-page-subheader>
            <ng-container appPageSubheaderTitle>Preferred Name</ng-container>
            <ng-container appPageSubheaderSummary>
              If you use a name professionally that is different from your legal name, enter it here.
            </ng-container>
          </app-page-subheader>

          <div *ngFor="let field of [
                 { label: 'Preferred First Name', name: 'preferredFirstName'},
                 { label: 'Preferred Middle Name (Optional)', name: 'preferredMiddleName'},
                 { label: 'Preferred Last Name', name: 'preferredLastName'}
               ]"
               class="row">
            <div class="col">

              <mat-form-field class="w-100">
                <input matInput
                       [placeholder]="field.label"
                       [formControlName]="field.name">
                <mat-error>Required</mat-error>
              </mat-form-field>

            </div>
          </div>
        </section>

      </app-toggle-content>

    </section>

    <section class="mb-3">

      <app-page-subheader>
        <ng-container appPageSubheaderTitle>Address</ng-container>
        <ng-container appPageSubheaderSummary>
          The information below comes from your BC Services Card. If you would prefer to receive mail at a professional
          or other address, select "I have a preferred address."
          <small class="font-italic d-block">
            Entering a preferred address in PRIME will not change your BC Services Card address.
          </small>
        </ng-container>
      </app-page-subheader>

      <app-bcsc-profile [user]="enrollee"
                        [showPersonal]="false"
                        [showAddressTitle]="false"></app-bcsc-profile>

      <app-toggle-content label="I have a preferred mailing address"
                          [checked]="hasMailingAddress"
                          (change)="onMailingAddressChange($event)">

        <section>
          <app-page-subheader>
            <ng-container appPageSubheaderTitle>Mailing Address</ng-container>
          </app-page-subheader>

          <app-address [form]="mailingAddress"
                       [bcOnly]="true"
                       [showManualButton]="true"
                       [showAddressFields]="hasMailingAddress"></app-address>
        </section>

      </app-toggle-content>

      <app-toggle-content label="I have a preferred physical address"
                          [checked]="hasPhysicalAddress"
                          (change)="onPhysicalAddressChange($event)">

        <section>
          <app-page-subheader>
            <ng-container appPageSubheaderTitle>Physical Address</ng-container>
          </app-page-subheader>

          <app-address [form]="physicalAddress"
                       [showManualButton]="true"
                       [showAddressFields]="hasPhysicalAddress"></app-address>
        </section>

      </app-toggle-content>

    </section>

    <app-contact-information-form [form]="form"></app-contact-information-form>

  </form>

  <app-page-footer [isInitialEnrolment]="isInitialEnrolment"
                   [hasSecondaryAction]="isProfileComplete"
                   (save)="onSubmit()"></app-page-footer>

</app-enrollee-page>
