<form [formGroup]="form"
      novalidate
      autocomplete="off">

  <section class="mb-3">
    <app-page-subheader2>
      <ng-container appPageSubheader2Title>{{ title }}</ng-container>
      <!-- Work around for ngProjectAs not passing directive reference to subheader2 when applied to ng-content -->
      <ng-container appPageSubheader2Summary>
        <ng-content select="[appPageSubheader2Summary]"></ng-content>
      </ng-container>
      <ng-container appPageSubheader2MoreInfo
                    *ngIf="hasPageSubheaderMoreInfo">
        <ng-content select="[appPageSubheader2MoreInfo]"></ng-content>
      </ng-container>
    </app-page-subheader2>

    <ul class="list-unstyled mb-4 ml-3">
      <li *ngFor="let contact of contacts; index as i;">
        <mat-card>
          <mat-card-title>
            <mat-icon color="primary">account_circle</mat-icon>
            {{ title }} #{{ i + 1 }} {{ contact.firstName }} {{ contact.lastName }}
          </mat-card-title>
          <mat-card-content>
            <div class="row">
              <div class="col">Job title: <span>{{ contact.jobRoleTitle }}</span></div>
              <div class="col">
                <button class="float-right"
                        type="button"
                        mat-stroked-button
                        (click)="updateContact(contact)">Update Information
                </button>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </li>
    </ul>

    <button *ngIf="showAddButton"
            mat-button
            type="button"
            class="mb-4"
            color="primary"
            (click)="addContact()">
      <mat-icon>add</mat-icon>
      Add {{ title }}
    </button>

    <ng-content *ngIf="showFormFields"
                select="app-same-as"></ng-content>

    <div class="row"
         *ngIf="showFormFields">
      <div class="col-12">

        <mat-form-field class="w-100">
          <input matInput
                 placeholder="First Name"
                 formControlName="firstName">
          <mat-error>Required</mat-error>
        </mat-form-field>

      </div>
      <div class="col-12">

        <mat-form-field class="w-100">
          <input matInput
                 placeholder="Last Name"
                 formControlName="lastName">
          <mat-error>Required</mat-error>
        </mat-form-field>

      </div>
      <div class="col-12">

        <mat-form-field class="w-100">
          <input matInput
                 placeholder="Job Title"
                 formControlName="jobRoleTitle">
          <mat-error>Required</mat-error>
        </mat-form-field>

      </div>
    </div>
  </section>

  <section *ngIf="showFormFields"
           class="mb-3">
    <app-page-subheader2>
      <ng-container appPageSubheader2Title>{{ title }} Contact Information</ng-container>
    </app-page-subheader2>

    <div class="row">
      <div class="col-12">

        <mat-form-field class="w-100">
          <input matInput
                 placeholder="Email"
                 formControlName="email">
          <mat-error *ngIf="email.hasError('required')">Required</mat-error>
          <mat-error *ngIf="email.hasError('email')">Must be a valid email address</mat-error>
        </mat-form-field>

      </div>
      <div class="col-12">

        <mat-form-field class="w-100">
          <input matInput
                 placeholder="Phone"
                 formControlName="phone"
                 mask="(000) 000-0000"
                 [showMaskTyped]="false">
          <mat-error *ngIf="phone.hasError('required')">Required</mat-error>
          <mat-error *ngIf="phone.hasError('phone')">Must be a valid phone number</mat-error>
        </mat-form-field>

      </div>
      <div *ngIf="showFax"
           class="col-12">

        <mat-form-field class="w-100">
          <input matInput
                 placeholder="Fax (Optional)"
                 formControlName="fax"
                 mask="(000) 000-0000"
                 [showMaskTyped]="false">
          <mat-error *ngIf="fax.hasError('required')">Required</mat-error>
          <mat-error *ngIf="fax.hasError('phone')">Must be a valid phone number</mat-error>
        </mat-form-field>

      </div>
      <div class="col-12">

        <mat-form-field class="w-100">
          <input matInput
                 placeholder="SMS Phone (Optional)"
                 formControlName="smsPhone"
                 mask="(000) 000-0000"
                 [showMaskTyped]="false">
          <mat-error *ngIf="smsPhone.hasError('required')">Required</mat-error>
          <mat-error *ngIf="smsPhone.hasError('phone')">Must be a valid phone number</mat-error>
        </mat-form-field>

      </div>
    </div>
  </section>

  <mat-slide-toggle #sameAddressSlideToggle
                    class="mb-4"
                    color="primary"
                    [checked]="!hasPhysicalAddress"
                    (change)="onPhysicalAddressChange($event)">
    The {{ title }}'s mailing address is the same as the siteâ€™s address
  </mat-slide-toggle>

  <ng-container *ngIf="hasPhysicalAddress">

    <section class="mb-3">
      <app-page-subheader2>
        <ng-container appPageSubheader2Title>Address</ng-container>
      </app-page-subheader2>

      <app-address-form [form]="physicalAddress"
                        [showAddressFields]="showAddressFields"
                        [showManualButton]="true"></app-address-form>
    </section>

  </ng-container>
</form>
